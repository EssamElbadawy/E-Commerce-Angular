import{a as I,b as u,c as D,d as $,g as R,h as j,i as G,j as H,l as M}from"./chunk-R2JCKQ5X.js";import{e as N}from"./chunk-G75RCXI3.js";import{i as L,u as k,z as b}from"./chunk-AUG4K3LK.js";import{$ as q,Eb as s,Lb as w,Na as p,Ob as S,S as T,Y as C,Ya as E,cb as c,eb as F,ib as h,mb as r,nb as l,ob as A,vb as x,wb as y}from"./chunk-CDFBLEAI.js";import"./chunk-CWTPBX7D.js";var B=(()=>{let i=class i{constructor(){this._HttpClient=C(k)}checkOut(n,g){return this._HttpClient.post(`${b.baseUrl}/api/v1/orders/checkout-session/${n}?url=${b.appUrl}`,{shippingAddress:g})}gatorders(n){return this._HttpClient.get(`${b.baseUrl}/api/v1/orders/user/${n}`)}};i.\u0275fac=function(g){return new(g||i)},i.\u0275prov=T({token:i,factory:i.\u0275fac,providedIn:"root"});let e=i;return e})();var O=(e,i)=>({"is-valid":e,"is-invalid":i});function V(e,i){e&1&&(r(0,"p"),s(1,"City filed is required"),l())}function P(e,i){e&1&&(r(0,"p"),s(1,"min length 3 char"),l())}function z(e,i){e&1&&(r(0,"p"),s(1,"max length 20 char or equal"),l())}function J(e,i){if(e&1&&(r(0,"div",7),c(1,V,2,0,"p")(2,P,2,0)(3,z,2,0),l()),e&2){let o,n=y();p(),h(1,(o=n.shippingAddressForm.get("city"))!=null&&o.getError("required")?1:(o=n.shippingAddressForm.get("city"))!=null&&o.getError("minlength")?2:(o=n.shippingAddressForm.get("city"))!=null&&o.getError("maxlength")?3:-1)}}function K(e,i){e&1&&(r(0,"p"),s(1,"Phone is required"),l())}function Q(e,i){e&1&&(r(0,"p"),s(1,"must be enter a valid egyptian phone number contains 12 number"),l())}function W(e,i){if(e&1&&(r(0,"div",7),c(1,K,2,0,"p")(2,Q,2,0),l()),e&2){let o,n=y();p(),h(1,(o=n.shippingAddressForm.get("phone"))!=null&&o.getError("required")?1:(o=n.shippingAddressForm.get("phone"))!=null&&o.getError("pattern")?2:-1)}}function X(e,i){e&1&&(r(0,"p"),s(1,"Details is required"),l())}function Y(e,i){e&1&&(r(0,"p"),s(1,"min length 10 char"),l())}function Z(e,i){e&1&&(r(0,"p"),s(1,"max length 100 char or equal"),l())}function ee(e,i){if(e&1&&(r(0,"div",7),c(1,X,2,0,"p")(2,Y,2,0)(3,Z,2,0),l()),e&2){let o,n=y();p(),h(1,(o=n.shippingAddressForm.get("details"))!=null&&o.getError("required")?1:(o=n.shippingAddressForm.get("details"))!=null&&o.getError("minlength")?2:(o=n.shippingAddressForm.get("details"))!=null&&o.getError("maxlength")?3:-1)}}function te(e,i){e&1&&(r(0,"span"),A(1,"i",13),l())}var he=(()=>{let i=class i{constructor(){this._OrderService=C(B),this._FormBuilder=C(H),this._ActivatedRoute=C(N),this.cartId=E(""),this.isLoading=E(!1),this.shippingAddressForm=this._FormBuilder.group({city:[null,[u.required,u.minLength(3),u.maxLength(15)]],phone:[null,[u.required,u.pattern(/^01[0125][0-9]{8}$/)]],details:[null,[u.required,u.minLength(10),u.maxLength(100)]]})}ngOnInit(){this._ActivatedRoute.paramMap.subscribe({next:n=>{this.cartId.set(n.get("id"))}})}ordreSubmit(){this.isLoading.set(!0),this._OrderService.checkOut(this.cartId(),this.shippingAddressForm.value).subscribe({next:n=>{this.shippingAddressForm.valid&&n.status==="success"&&(this.isLoading.set(!1),window.open(n.session.url,"_self"))}})}};i.\u0275fac=function(g){return new(g||i)},i.\u0275cmp=q({type:i,selectors:[["app-order"]],standalone:!0,features:[w],decls:28,vars:18,consts:[[1,"bg-main-light","p-2","my-2","rounded-4","shadow","mx-auto","w-50","my-5"],[1,"text-center"],[3,"ngSubmit","formGroup"],[1,"mb-3"],["for","city"],[1,"text-danger"],["type","text","formControlName","city",1,"form-control",3,"ngClass"],[1,"alert","m-0","p-0","border-0","w-25","text-white","bg-main","text-center","fw-bold"],["for","phone"],["type","tel","formControlName","phone",1,"form-control",3,"ngClass"],["for","details"],["type","text","formControlName","details",1,"form-control",3,"ngClass"],["type","submit",1,"btn","bg-main","text-white","px-4",3,"click","disabled"],[1,"fas","fa-spin","fa-spinner","text-white"]],template:function(g,t){if(g&1&&(r(0,"section",0)(1,"h1",1),s(2,"Shipping Address"),l(),r(3,"form",2),x("ngSubmit",function(){return t.ordreSubmit()}),r(4,"div",3)(5,"label",4),s(6,"City:"),r(7,"span",5),s(8,"*"),l()(),A(9,"input",6),c(10,J,4,1,"div",7),l(),r(11,"div",3)(12,"label",8),s(13,"Phone:"),r(14,"span",5),s(15,"*"),l()(),A(16,"input",9),c(17,W,3,1,"div",7),r(18,"div",3)(19,"label",10),s(20,"Details"),r(21,"span",5),s(22,"*"),l()(),A(23,"input",11),c(24,ee,4,1,"div",7),l(),r(25,"button",12),x("click",function(){return t.ordreSubmit()}),s(26,"CheckOut "),c(27,te,2,0,"span"),l()()()()),g&2){let d,_,a,v,m,f;p(3),F("formGroup",t.shippingAddressForm),p(6),F("ngClass",S(9,O,!((d=t.shippingAddressForm.get("city"))!=null&&d.errors)&&(((d=t.shippingAddressForm.get("city"))==null?null:d.touched)||((d=t.shippingAddressForm.get("city"))==null?null:d.dirty)),((d=t.shippingAddressForm.get("city"))==null?null:d.errors)&&(((d=t.shippingAddressForm.get("city"))==null?null:d.touched)||((d=t.shippingAddressForm.get("city"))==null?null:d.dirty)))),p(),h(10,(_=t.shippingAddressForm.get("city"))!=null&&_.errors&&((_=t.shippingAddressForm.get("city"))!=null&&_.touched||(_=t.shippingAddressForm.get("city"))!=null&&_.dirty)?10:-1),p(6),F("ngClass",S(12,O,!((a=t.shippingAddressForm.get("phone"))!=null&&a.errors)&&(((a=t.shippingAddressForm.get("phone"))==null?null:a.touched)||((a=t.shippingAddressForm.get("phone"))==null?null:a.dirty)),((a=t.shippingAddressForm.get("phone"))==null?null:a.errors)&&(((a=t.shippingAddressForm.get("phone"))==null?null:a.touched)||((a=t.shippingAddressForm.get("phone"))==null?null:a.dirty)))),p(),h(17,(v=t.shippingAddressForm.get("phone"))!=null&&v.errors&&((v=t.shippingAddressForm.get("phone"))!=null&&v.touched)?17:-1),p(6),F("ngClass",S(15,O,!((m=t.shippingAddressForm.get("details"))!=null&&m.errors)&&(((m=t.shippingAddressForm.get("details"))==null?null:m.touched)||((m=t.shippingAddressForm.get("details"))==null?null:m.dirty)),((m=t.shippingAddressForm.get("details"))==null?null:m.errors)&&(((m=t.shippingAddressForm.get("details"))==null?null:m.touched)||((m=t.shippingAddressForm.get("details"))==null?null:m.dirty)))),p(),h(24,(f=t.shippingAddressForm.get("details"))!=null&&f.errors&&((f=t.shippingAddressForm.get("details"))!=null&&f.touched||(f=t.shippingAddressForm.get("details"))!=null&&f.dirty)?24:-1),p(),F("disabled",t.shippingAddressForm.invalid||t.isLoading()),p(2),h(27,t.isLoading()?27:-1)}},dependencies:[M,R,I,D,$,j,G,L]});let e=i;return e})();export{he as OrderComponent};
